{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-00b432e1\"],{1:function(e,t){},2:function(e,t){},\"2b93\":function(e,t,a){\"use strict\";a(\"2f3f\")},\"2f3f\":function(e,t,a){},3:function(e,t){},ad43:function(e,t,a){\"use strict\";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"export-excel-wrapper\"},[a(\"Hints\",[a(\"template\",{slot:\"hintName\"},[e._v(\"JS-xlsx插件\")]),a(\"template\",{slot:\"hintInfo\"},[a(\"p\",[e._v(\"JS-xlsx：由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库，功能强大，支持xlsx、csv、txt等格式\")]),a(\"p\",[e._v(\"github地址：访问\\n                \"),a(\"el-link\",{attrs:{type:\"success\",href:\"https://github.com/SheetJS/sheetjs\",target:\"_blank\"}},[e._v(\"JS-xlsx\")])],1)])],2),a(\"el-card\",{attrs:{shadow:\"always\"}},[a(\"el-form\",{ref:\"searchForm\",staticClass:\"search-form\",attrs:{inline:!0,model:e.exportParam,\"label-width\":\"100px\"}},[a(\"el-form-item\",{attrs:{label:\"文件名:\"}},[a(\"el-input\",{attrs:{placeholder:\"文件名\"},model:{value:e.exportParam.fileName,callback:function(t){e.$set(e.exportParam,\"fileName\",t)},expression:\"exportParam.fileName\"}})],1),a(\"el-form-item\",{attrs:{label:\"自动宽度:\"}},[a(\"el-radio-group\",{model:{value:e.exportParam.autoWidth,callback:function(t){e.$set(e.exportParam,\"autoWidth\",t)},expression:\"exportParam.autoWidth\"}},[a(\"el-radio\",{attrs:{label:!0}},[e._v(\"自动\")]),a(\"el-radio\",{attrs:{label:!1}},[e._v(\"固定\")])],1)],1),a(\"el-form-item\",{attrs:{label:\"文件类型:\"}},[a(\"el-select\",{attrs:{placeholder:\"文件类型\"},model:{value:e.exportParam.type,callback:function(t){e.$set(e.exportParam,\"type\",t)},expression:\"exportParam.type\"}},[a(\"el-option\",{attrs:{value:\"xlsx\",label:\"xlsx\"}}),a(\"el-option\",{attrs:{value:\"csv\",label:\"csv\"}}),a(\"el-option\",{attrs:{value:\"txt\",label:\"txt\"}})],1)],1),a(\"el-form-item\",[a(\"el-button\",{staticStyle:{\"margin-left\":\"30px\"},attrs:{type:\"primary\"},on:{click:e.handleExport}},[e._v(\"导出Excel\")])],1)],1),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],ref:\"multipleTable\",staticStyle:{width:\"100%\"},attrs:{data:e.tableData,\"tooltip-effect\":\"dark\",size:\"medium\"},on:{\"selection-change\":e.handleSelectionChange}},[a(\"el-table-column\",{attrs:{type:\"selection\",width:\"50\",align:\"center\"}}),a(\"el-table-column\",{attrs:{prop:\"id\",label:\"编号\",align:\"center\"}}),a(\"el-table-column\",{attrs:{prop:\"name\",label:\"姓名\",align:\"center\"}}),a(\"el-table-column\",{attrs:{prop:\"sex\",label:\"性别\",align:\"center\"}}),a(\"el-table-column\",{attrs:{prop:\"phone\",label:\"手机\",align:\"center\"}}),a(\"el-table-column\",{attrs:{prop:\"education\",label:\"学历\",align:\"center\"}}),a(\"el-table-column\",{attrs:{prop:\"hobby\",label:\"爱好\",align:\"center\",width:\"300\"}})],1)],1)],1)},n=[],o=(a(\"4160\"),a(\"b0c0\"),a(\"159b\"),a(\"4ec3\")),r=a(\"cd77\"),i=a(\"b522\"),c={name:\"ExportExcel\",components:{Hints:i[\"a\"]},data:function(){return{listLoading:!0,exportParam:{fileName:\"\",autoWidth:!0,type:\"xlsx\"},tableData:[],multipleSelection:[]}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(o[\"a\"])(this.exportParam).then((function(t){var a=t.data;0===a.code&&(a.data.list.forEach((function(t){var a=t.id,l=t.name,n=t.sex,o=t.phone,r=t.education,i=t.hobby;e.tableData.push({id:a,name:l,sex:n,phone:o,education:r,hobby:i})})),e.listLoading=!1)})).catch((function(){e.listLoading=!1}))},handleSelectionChange:function(e){this.multipleSelection=e},handleExport:function(){if(this.multipleSelection.length){var e={header:[\"编号\",\"姓名\",\"性别\",\"手机\",\"学历\",\"爱好\"],key:[\"id\",\"name\",\"sex\",\"phone\",\"education\",\"hobby\"],data:this.multipleSelection,autoWidth:this.exportParam.autoWidth,fileName:this.exportParam.fileName,bookType:this.exportParam.type};r[\"a\"].exportDataToExcel(e),this.$refs.multipleTable.clearSelection()}else this.$message.warning(\"请勾选要导出的数据项！\")}}},s=c,u=(a(\"2b93\"),a(\"2877\")),p=Object(u[\"a\"])(s,l,n,!1,null,null,null);t[\"default\"]=p.exports},cd77:function(e,t,a){\"use strict\";a(\"99af\"),a(\"d81d\"),a(\"c19f\"),a(\"d3b7\"),a(\"25f0\"),a(\"5cc6\"),a(\"9a8c\"),a(\"a975\"),a(\"735e\"),a(\"c1ac\"),a(\"d139\"),a(\"3a7b\"),a(\"d5d6\"),a(\"82f8\"),a(\"e91f\"),a(\"60bd\"),a(\"5f96\"),a(\"3280\"),a(\"3fcc\"),a(\"ca91\"),a(\"25a1\"),a(\"cd26\"),a(\"3c5d\"),a(\"2954\"),a(\"649e\"),a(\"219c\"),a(\"170b\"),a(\"b39a\"),a(\"72f7\");var l=a(\"1146\"),n=a.n(l),o=a(\"21a6\");function r(e,t){for(var a=t.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}}))})),l=a[0],n=1;n<a.length;n++)for(var o=0;o<a[n].length;o++)l[o].wch<a[n][o].wch&&(l[o].wch=a[n][o].wch);e[\"!cols\"]=l}function i(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))}function c(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),l=0;l!==e.length;++l)a[l]=255&e.charCodeAt(l);return t}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.header,a=e.key,l=e.data,s=e.fileName,u=e.autoWidth,p=void 0===u||u,h=e.bookType,d=void 0===h?\"xlsx\":h,f=n.a.utils.book_new(),m=i(a,l);s=s||\"excel-list\",m.unshift(t);var b=n.a.utils.aoa_to_sheet(m);p&&r(b,m),n.a.utils.book_append_sheet(f,b,s);var x=n.a.write(f,{bookType:d,bookSST:!1,type:\"binary\"});Object(o[\"saveAs\"])(new Blob([c(x)],{type:\"application/octet-stream\"}),\"\".concat(s,\".\").concat(d))}function u(e){var t,a=[],l=n.a.utils.decode_range(e[\"!ref\"]),o=l.s.r;for(t=l.s.c;t<=l.e.c;++t){var r=e[n.a.utils.encode_cell({c:t,r:o})],i=\"UNKNOWN \"+t;r&&r.t&&(i=n.a.utils.format_cell(r)),a.push(i)}return a}function p(e,t){var a=n.a.read(e,{type:t}),l=a.SheetNames[0],o=a.Sheets[l],r=u(o),i=n.a.utils.sheet_to_json(o);return{header:r,results:i}}t[\"a\"]={exportDataToExcel:s,readDataFromExcel:p}}}]);","extractedComments":[]}